[TOC]


# 操作系统知识点
***
##  一.计算机系统概述  

###  1.操作系统的概念  
操作系统是控制和管理整个计算机系统的硬件与软件资源，是计算机系统中最基本的系统软件。

###  2.操作系统的特征

#### <1>并发
**并发是指两个或多个时间在同一时间间隔内发生。引入的目的是使程序能并发执行。  
并发是在同一时间间隔内发生，并行指同一时刻进行。  
操作系统的并发性是通过分时得以实现的。**

#### <2>共享
共享即资源共享，是指系统中的资源可供内存中多个并行执行的进程共同使用。  
1. 互斥共享方式  
规定时间内只允许一个进程访问该资源。  
当一个进程访问该资源时，其他资源要访问该资源就要等待。只有第一个进程访问完并释放该资源后，另一个进程才可以访问。  
**这种在一个时间段内只允许一个进程访问的资源称为临界资源或独占资源。**  
2. 同时访问方式  
在一段时间内由多个进程“同时”访问。这个同时是宏观上的，在微观上的这些进程可能是交替地对该资源进行访问即“分时共享”  
并发和共享是操作系统两个最基本特征，两者之间互为存在条件：1，资源共享是以程序的并发为条件的，若系统不允许程序并发执行则自然不存在资源共享问题。2，若系统不能对资源共享实施有效管理，必然会影响程序的并发执行。  
#### <3>虚拟  
虚拟是指把一个物理上的实体变为若干逻辑上对应物。
**利用多道程序设计技术，让每个用户都觉得有一个计算机为他服务**  
**时分复用**：利用设备空闲时间内为其他用户服务。如虚拟处理器。  
**空分复用**：利用存储器的空闲空间分区域存放和运行其他的多道程序，一次提高内存利用率。  
#### <4>异步  
在多道程序运行中，程序的执行不是一贯到底的，而是走走停停，向前推进的速度不可预知，这就是进程的异步性。

###  3.操作系统的目标  

#### <1>操作系统作为计算机系统资源的管理者  

##### #1处理机管理  
在多道程序环境下，处理及的分配和运行都以进程(或线程)为基本单位，所以处理机的管理可归结为对进程的管理。  
进程何时创建，何时撤销，如何管理，如何避免冲突，合理共享就是进程管理的主要任务。  
进程管理的主要功能包括进程控制，进程同步，进程通讯，死锁处理，处理机调度。  

##### #2存储器管理  
存储器管理目的是提高内存的利用率。  
主要任务是内存分配，地址映射，内存保护与共享和内存扩充。  

##### #3文件管理  
操作系统中负责文件管理的部分称为文件系统。  
文件管理包括存储空间的管理，目录管理，及文件读写管理和保护等。  

##### #4设备管理  
设备管理的主要任务是完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率。  
主要包括文件存储空间的管理，目录管理及文件读写管理和保护。

#### <2>操作系统作为用户与计算机硬件系统之间的接口  
##### #1 命令接口：用户利用命令接口来组织和控制作业的执行。  
**联机命令接口**：又称为交互式命令接口，适用于分时或实时系统的接口。用户输入一条命令系统执行一条。  
**脱机命令接口**：又称为批处理命令接口，适用于批处理系统。用户输入一组命令，系统依次执行，全部执行结束后，用户可以再次输入。  
##### #2程序接口：编程人员可以使用他们来请求操作系统服务。  
程序接口由一组 **系统调用命令（简称系统调用，也称广义指令）** 组成。* .dll文件就是封装了各种服务。  

#### <3>操作系统用作扩充机器  
没有操作系统的机器叫裸机。

### 4.操作系统的发展与分类  

#### <1>手工操作阶段（无操作系统）
缺点：1，用户独占全机，资源利用率低。2，CPU等待手工操作，CPU利用不充分。  

#### <2>批处理阶段

##### #1单道批处理系统
系统对作业的处理是成批进行的，内存中始终保持一道作业。  
1. 自动性。顺利的情况下，磁带上的一批作业自动逐个运行，无需人工干预。  
2. 顺序性。磁带上各道作业顺序进入内存，完成顺序与进入顺序相同。  
3. 单道性。内存中仅有一道程序。当前一个程序完成或者异常时，下一道程序才会进入内存。  

缺点：内存仅一道作业，CPU运行时发出输入/输出指令，需要等待I/O设备。  
##### #2多道批处理系统
允许多个程序同时进入内存，并允许他们在CPU中交替运行。当一道程序因I/O请求而暂停运行时，CPU便立即执行另一道程序。  
1. 多道。内存中同时存放多道程序。  
2. 宏观上并行。同时进入系统的多道程序都处于运行过程中，他们先后运行。
3. 微观上串行。多道程序轮流占用CPU，交替执行。   

缺点：用户响应时间较长，不提供人机交互能力，用户不了解程序的运行情况，又不能控制计算机。

#### 分时操作系统
分时是指把处理器的运行时间分成很短的时间片，按时间片轮流吧处理器分配给各联机作业使用。    
1. 同时性。同时性也称多路性，指允许多个终端用户同时使用一台计算机，用户基本同时使用计算机。  
2. 交互性。用户通过终端采用人机对话的方式直接控制程序运行，同程序交互。  
3. 独立性。系统中多个用户可以彼此独立地进行操作，互不干扰。单个用户感觉不到别人也在使用这台计算机。  
4. 及时性。用户请求可以在短时间内的到响应。  

缺点：在一些应用场合，需要系统对外部的信息在规定时间内处理（导弹发射）。  

#### 实时操作系统
为了能在某个时间限制内完成某些紧急任务而不需要时间片排队，诞生了实时操作系统。  
1. 硬实时系统。必须在规定时刻完成。  
2. 软实时系统。可以偶尔超出时间规定。  

#### 网络操作系统和分布式计算机系统
网络操作系统把计算机网络中各台计算机结合在一起，提供有效的使用各台计算机的方法，实现各台计算机之间的数据传送。特点是资源共享和计算机之间的通信。  
分布式计算机系统条件：1，系统中任意两台计算机通过通信方式交换信息；2，每台计算机有相同地位；3，计算机的资源为所有用户共享；4，任一台计算机都可以构成子系统；5，任何工作可以分布在几台计算机上，协同工作。特点是分布性和并行性。  
两个的区别是分布式计算机系统若干台计算机相互协同完成同一工作。

### 5.操作系统的运行环境

#### 5.1操作系统的运行机制

通常CPU执行两种不同性质的程序：内核程序和应用程序。  
系统内核程序（管理程序）会执行一些特权指令，特权指令是指计算机不允许用户直接使用的指令。应用程序出于安全考虑也不能执行特权指令。如：I/O指令，置中断指令等。  
CPU的状态划分为 **用户态（目态）** 和 **核心态（管态，内核态）** 。应用程序运行在用户态，内核程序运行在核心态。  
**内核** 是计算机上配置的底层软件，是计算机功能的延伸。不同系统对内核定义稍有区别（大内核和微内核）。  

1. **时钟管理**

 + 时钟的第一功能是计时，操作系统通过时钟管理向用户提供标准系统时间。  
 + 通过时钟中断的处理，实现进程的切换。  
2. **中断机制**  
引入中断技术的初衷是提高多道程序运行环境中CPU的利用率，且主要针对外部设备，后来的到了发展。  
键盘或鼠标信息输入，进程的管理和调度，系统功能的调用，设备驱动，文件访问都依赖中断机制。  
中断机制中只有一小部分功能属于内核，负责保护和回复中断现场信息，转移控制权到相关处理程序。这样减少中断时间，提高系统并行处理能力。  
3. **原语**  

 + 处于操作系统的最底层，是最接近硬件的部分。
 + 程序的运行具有原子性，运行必须一气呵成。
 + 运行时间短，调用频繁。   

 具有这些特点的 **程序** 称为 **原语** 。
4.系统控制的数据结构及处理  
 系统采用登记状态信息的数据结构有很多，如：作业控制块，进程控制块（PCB），设备控制块等。管理这些数据结构的一些基本操作：  
  + 进程管理。进程状态管理、进程调度和分配、创建于撤销进程控制块等。
  + 存储器管理。 存储器空间分配和回收等。
  + 设备管理。 缓冲区管理、设备分配和回收等。  

#### 5.2中断和异常的概念
操作系统有用户态和核心态两种工作状态。实际操作中通过一些方法来切换状态如：用一个寄存器的一位来表示工作状态，0表示核心态，1表示用户态。引入中断机制，实现了多道程序并发执行。  
**发生中断就意味着需要操作系统介入，开展管理工作**  
1. 中断发生时，CPU立即进入核心态。
2. 发生中断后，当前进程暂停运行，有操作系统内核对中断进行处理。
3. 对于不同中断信号，有不同处理。
4. **用户态到核心态的切换是通过中断实现的，并且中断时唯一途径。**  
5. 核心态到用户态的转换是通过执行一个特权指令，将程序状态字（PSW）的标志位设置为用户态。

##### #1中断和异常的定义  
中断信号来源于CPU内部是内中断，与当前执行的指令有关。来源于外部为外中断，与当前指令无关。  
1. 中断也成为外中断。如：I/O设备操作完成时发出的中断信号。
2. 内中断也称为异常，例外，陷入。自愿中断（指令中断）属于内中断，如系统调用时使用的访管指令（陷入指令，trap指令）。缺页中断属于强迫中断当中的硬件故障情况。软件中断也属于强迫中断（算术溢出）。  

##### #2外中断处理过程  
1. 关中断。 使CPU不再响应更高级中断源的中断请求。  
2. 保存断点。中断服务程序执行完毕后会返回断点。  
3. 引出中断服务程序。 实质是去除中断服务程序的入口地址送入程序计数器PC。  
4. 保存现场和屏蔽字。 进入中断服务程序后，首先保存现场，现场信息一般是指程序状态字寄存器PSWR和通用寄存器内容。  
5. 开中断。允许更高级的中断请求。
6. 执行中断服务程序。
7. 关中断。
8. 恢复现场和屏蔽字。
9. 开中断,中断返回。  
其中1-3步是在CPU进入中断周期后，由硬件自动（中断隐指令）完成的；4-9步有中断服务程序完成。  

#### 5.3系统调用
系统调用是用户在程序中调用操作系统所提供的一些子功能。  
系统中的各种共享资源都有操作系统统一掌管，所以用户程序中与资源有关的操作（存储分配、I/O操作，文件管理等）都必须通过系统调用方式向操作系统提出服务请求。  
**系统调用的相关处理需要在核心态下进行**  
用户程序执行陷入指令（又称访管指令或trap指令）发起系统调用。
陷入指令相当于把CPU的使用权主动交给操作系统内核程序（用户态切换到核心态）,内核程序对系统调用请求作出处理。处理完成后，内核程序将CPU使用权交还给用户程序（核心态切换到用户态）。
**陷入指令是唯一一个只能在用户态执行，而不可在核心态执行的指令。**

##  二.进程管理  

### 1进程概念

##  三.内存管理  

##  四.文件管理  

##  五.输入/输出（I/O）管理

##  
